<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            background: #111;
            color: #eee;
            display: flex;
            height: 100vh;
            align-items: center;
            justify-content: center;
            margin: 0;
        }
        .card {
            background: #222;
            padding: 2rem;
            border-radius: 12px;
            width: 100%;
            max-width: 400px;
            text-align: center;
            border: 1px solid #333;
        }
        .drop {
            border: 2px dashed #444;
            padding: 3rem 1rem;
            margin: 1.5rem 0;
            border-radius: 8px;
            cursor: pointer;
            transition: 0.2s;
        }
        .drop:hover { border-color: #666; background: #2a2a2a; }
        button {
            background: #fff;
            color: #000;
            border: none;
            padding: 0.8rem;
            width: 100%;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
        }
        button:disabled { opacity: 0.5; cursor: not-allowed; }
        #status { margin-top: 1rem; font-size: 0.9rem; color: #888; word-break: break-all; }
    </style>
</head>
<body>
    <div class="card">
        <h2 style="margin:0 0 0.5rem">Upload Video</h2>
        <div class="drop" id="drop">Click or drop video</div>
        <input type="file" id="file" accept="video/*" hidden>
        <button id="btn" disabled>Upload</button>
        <div id="status"></div>
    </div>
    <script>
        const drop = document.getElementById('drop');
        const fileInput = document.getElementById('file');
        const btn = document.getElementById('btn');
        const status = document.getElementById('status');
        let file;

        const setFile = (f) => {
            if (!f?.type.startsWith('video/')) return status.innerText = 'Video only';
            file = f;
            status.innerText = f.name;
            btn.disabled = false;
        };

        drop.onclick = () => fileInput.click();
        drop.ondragover = e => { e.preventDefault(); drop.style.borderColor = '#888'; };
        drop.ondragleave = () => drop.style.borderColor = '#444';
        drop.ondrop = e => { e.preventDefault(); setFile(e.dataTransfer.files[0]); };
        fileInput.onchange = e => setFile(e.target.files[0]);

        btn.onclick = () => {
            if (!file) return;
            btn.disabled = true;
            btn.innerText = 'Uploading...';
            const xhr = new XMLHttpRequest();
            xhr.upload.onprogress = e => status.innerText = `${Math.round((e.loaded/e.total)*100)}%`;
            xhr.onload = () => {
                btn.innerText = 'Upload';
                if (xhr.status < 300) {
                    status.innerHTML = `<a href="${xhr.responseText}" target="_blank" style="color:#fff">${xhr.responseText}</a>`;
                    file = null;
                    btn.disabled = false;
                } else {
                    status.innerText = 'Error';
                    btn.disabled = false;
                }
            };
            xhr.onerror = () => { status.innerText = 'Error'; btn.disabled = false; };
            xhr.open('POST', '/upload');
            const fd = new FormData();
            fd.append('video', file);
            xhr.send(fd);
        };
    </script>
</body>
</html>